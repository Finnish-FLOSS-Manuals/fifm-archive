<html xmlns="http://www.w3.org/1999/xhtml" dir="LTR"><head><title>Asiakaspuoli</title><link rel="icon" href="/static/fl2.ico" type="image/x-icon"><link rel="stylesheet" href="/static/templating_template_flossmanuals.css" type="text/css"><script type="text/javascript" src="/static/jquery.js"></script><script type="text/javascript" src="/static/templating_template_flossmanuals.js"></script></head><body>
<div id="home">
  <a href="/"><img src="/static/top_read_back.gif" border="0" alt=""></a>
</div>
<div id="index">
  <a href="/rsence/index" id="index-book-title"><div Class="book-title-goes-here">RSence</div></a>
  <ul Class="menu-goes-here"><li Class="booki-section">Johdanto</li><li><a href="/rsence/index">Johdanto</a></li>
<li Class="booki-section">Asennus</li><li><a href="/rsence/ch003_asennus">Asennus</a></li>
<li Class="booki-section">Perusteet</li><li><a href="/rsence/ch005_alustus">Alustus</a></li>
<li><a href="/rsence/ch006_tarkastaminen">Tarkastaminen</a></li>
<li><a href="/rsence/ch007_ajaminen">Ajaminen</a></li>
<li Class="booki-section">Ohjelmointi</li><li><a href="/rsence/ch009_ohjelmointi">Ohjelmointi</a></li>
<li><a href="/rsence/ch010_asiakaspuoli">Asiakaspuoli</a></li>
<li><a href="/rsence/ch011_palvelinpuoli">Palvelinpuoli</a></li>
<li Class="booki-section">Lähdekoodi</li><li><a href="/rsence/ch013_fiveryaml">fiver.yaml</a></li>
<li><a href="/rsence/ch014_fiverrb">fiver.rb</a></li>
<li><a href="/rsence/ch015_valuesyaml">values.yaml</a></li>
<li><a href="/rsence/ch016_client_pkgsyaml">client_pkgs.yaml</a></li>
<li><a href="/rsence/ch017_fiverjs">fiver.js</a></li>
<li><a href="/rsence/ch018_fivercss">fiver.css</a></li>
<li><a href="/rsence/ch019_fiverhtml">fiver.html</a></li>
<li Class="booki-section">Dokumentaatio</li><li><a href="/rsence/ch021_dokumentaatio">Dokumentaatio</a></li>
<li Class="booki-section">Tekijät</li><li><a href="/rsence/ch023_tekijat">Tekijät</a></li>
</ul></div>
<!--
<div id="pdf">
  <a href="something.pdf"><img class="non" src="/static/makepdf.gif" border="0" alt="" /></a>
  <a href="something"><img class="non" src="/static/viewprint.gif" border="0" alt="" /></a>
</div>
-->
<div id="main">
  <div class="navbar">
    <div class="arrow top left"><a href="#"><img src="/static/lefttext.png" height="20" alt=""></a></div>
    <div class="arrow top right"><a href="#"><img src="/static/righttext.png" height="20" alt=""></a></div>
  </div>

  <div class="ds-contentcontainer">
    <div id="main-content">
<h1>Asiakaspuolen ulkoasu ja toiminnallisuus
</h1>
<p>RSencen dokumentaatio listaa seuraavat tarkoitukset ja ominaisuudet gui/main.yaml-tiedostolle.
</p>
<ul><li>Se voidaan nimetä myös sovelluslaajennuksen mukaan, kuten esimerkiksi
  <br>fiver.yaml.</li>
  <li>Se määrittelee käyttöliittymän rakenteen.</li>
  <li>Se sisältää asiakaspuolen arvojen sidonnaisuudet (value bindings), jotka tulee olla määriteltynä esimerkiksi values.yaml-tiedostossa.</li>
  <li>Se voi määritellä myös staattisia tietoja tai paikallisia merkkijonoa.</li>
  <li>Järjestelmä rakentaa käyttöliittymän perustuen tähän tiedostoon automaattisesti, kun RSence verkkosivu ladataan tai kun se uudelleen ladataan käyttäjän toimesta.</li>
</ul><p>Tehtäessä yaml-tiedostoja on huomioitava se, että yaml-merkintäkieli on tarkka sisennyksien suhteen ja väärin tehdyt sisennykset johtavat normaalisti siitä, että ohjelma ei toimi ollenkaan.
  <br></p>
<p>Lähdekoodi gui/fiver.yaml-tiedostosta on kokonaisuudessaan luettavissa liitteessä. Yaml-tiedoston alussa käydään läpi käyttöliittymään liittyvät JavaScript-luokat. Jos käytetään itse tehtyjä komponentteja, kuten Fiverissa olevaa noppakomponenttia, tulee sen sijainti ilmoittaa myös sovelluslaajennuksen päähakemistossa sijaitsevassa client_pkgs.yaml-tiedostossa, joka löytyy kokonaisuudessaan liitteestä.
</p>
<p><img title="ScreenHunter_04_Nov._27_21.51" alt="ScreenHunter_04_Nov._27_21.51" src="_booki/rsence/static/RSence-resized_600x389_ScreenHunter_04_Nov-_27_21-51-fi.gif" height="389" width="600"></p>
<p>Kuvassa on merkittynä punaisella RSence-sovelluslaajennus Fiverin käyttämät komponentit. Komponentit käydään läpi lähdekooditasolla luvuissa. Fiverin käyttämät komponentit (lukuun ottamatta Hfiver-komponenttia) ovat yleiskäyttöisiä standardikomponentteja, joten lähdekooditason
  <br>esimerkkien avulla voidaan toteuttaa myös muita Rsencesovelluslaajennuksia.
</p>
<h2>HWindow
</h2>
<p>HWindow on Rsence-sovelluslaajennus Fivern alinäkymä, joka sitoo sisälleen muut sovelluslaajennuksessa käytettävät komponentit.
  <br></p>
<pre>- class: HWindow
rect: [0, 0, 800, 650]
options:close
Button: true
noResize: true
label: Fiver</pre>
<p>Yaml-kuvauksen ensimmäisellä rivillä todetaan, että kyseessä on HWindow-luokan vakiokomponentti. Tämän jälkeen kerrotaan sen sijainti selainikkunassa sekä komponentin mittasuhteet formaatissa [selain-x,selainy,komponentti-leveys,komponentti-korkeus]. RSencen palvelinpuolen APIdokumentaatio kuvaa erilaisia tapoja kuvata sijaintia, jolloin komponentit voidaan
  <br>määritellä myös joustavilla mittasuhteilla.
</p>
<p>
  <br>Tämän jälkeen kuvataan komponentin asetukset, jotka tässä tapauksessa määrittävät seuraavat seikat: 
</p>
<ul><li>closeButton : komponentti on suljettavissa sovelluksen vasemmasta
  <br>yläreunassa olevassa painikkeesta</li>
  <li>noResize: komponentin kokoa ei käyttäjän toimesta voida muuttaa</li>
  <li>label: komponentin, tässä tapauksessa ikkunan yläreunassa olevan
  <br>nimen sisältö.
  <br></li>
</ul><p>Lisää vaihtoehtoja asetuksiin löytyy asiakaspuolen API-dokumentaatiosta.
  <br></p>
<h2>HClickButton
</h2>
<p>HClickButton-komponenttia käytetään erilaisten painikkeiden luomiseen. Fiverissa HClickButton on HWindow-komponentin alinäkymänä, joten esimerkiksi sen sijainti- ja mittasuhdemäärittelyn x = 0 ja y = 0 kordinaattipiste sijaitsee HWindow-komponentin vasemmassa yläreunassa, eikä siis koko selainikkunan, jossa sovelluslaajennus pyörii.
</p>
<p>- class: HClickButton
  <br>rect: [35, 30, 85, 25]
  <br>bind: :values.submit_ones
  <br>options:
  <br>label: "Ones"
</p>
<p> HClickButton on sidottu bind:-määritteellä muuttujaan submit_ones, joka löytyy sovelluslaajennuksen juurikansiosta tiedostossa values.yaml, jonka lähdekoodi on kokonaisuudessaan luettavissa liittessä. Kun komponentti on sidottu muuttujaan, voidaan sen arvoa käsitellä palvelinpuolen logiikkaa määriteltässä. Normaalisti kaikki komponentit on sidottu muuttujiin, mutta poikkeuksiakin on, kuten HWindow komponentti. Seuraavana on listattu esitellyn HClickButtoniin sidottu :submit_ones:in lähdekoodi values.yaml-tiedostossa.
  <br></p>
<pre>:submit_ones:
:value: 0
:responders:
- :method: submit_ones</pre>
<p>Edellä olevassa on aluksi esitelty muutujan nimi, sitten alkuarvo sekä vastaaja responder. Vastaaja laukaisee palvelinpuolen logiikasta metodin submit_ones, joka esitellään tarkemmin luvussa 5.3.3. Values.yaml-tiedosto mahdollistaa kaksisuuntaisen tiedon vaihdon asiakaspuolen ja palvelinpuolen
  <br>välillä.
  <br></p>
<h2>HStringView
</h2>
<p>HStringView on merkkijonojen esittämistä varten tehty komponentti. Alla olevassa lähdekoodinpätkässä gui/fiver.yaml-tiedostossa havainnollistetaan staatisen merkkijonon käyttämistä HStringViewin kautta.
  <br></p>
<pre>- class: HStringView
rect: [20, 5, 125, 20]
options:
value: "&lt;b&gt;UPPER SECTION&lt;/b&gt;"</pre>
<p>Merkkijonon sisältö laitetaan value:-asetukseen, jossa voidaan käyttää esimerkin mukaisesti HTML-merkintäkieltä.
</p>
<h2>HCheckbox
</h2>
<p>HCheckbox-komponentti tekee käyttöliittymään valintalaatikon, jonka arvo vaihtelee valitun, True, ja ei-valitun, False, välillä. HCheckBox toteutetaan muuten hyvin samalla tavalla kuin aiemmin selitetty HClickButton.
</p>
<h2>Hfiver –lisäkomponentti
  <br></h2>
<p>Hfiver on Fiver-sovelluslaajennuksen ainoa vakiokomponenttikirjaston ulkopuolelta tuleva lisäkomponentti. Se perustuu RSencen verkkosivuilla olevaan komponenttiesimerkkiin, jota laajensin sopivaksi omaan sovelluslaajennukseeni.
</p>
<p>Hfiver näyttää gui/fiver.yaml-tiedostossa samankaltaiselta kuin aiemmin esitetyt komponentit.
</p>
<pre>- class: Hfiver
rect: [275, 175, 60, 60]
bind: :values.die_one</pre>
<p>Koska kyseessä on lisäkomponentti, on sen toiminnallisuus ja ulkoasu theme erikseen määritely sovelluslaajennuksen js-kansiossa tai kansiossa, joka on määritelty client_pkgs.yaml-tiedostossa.
  <br>Noppa-komponentti toimii niin, että painettaessa Roll-painiketta, laukaisee se vastaajan, joka puolestaan laukaisee palvelinpuolen metodin roll(), joka arpoo satunnaisluvun 1-6 välillä ja palauttaa sen takaisin values.yamltiedoston kautta gui/fiver.yaml-tiedostoon, joka päivittää lukeman nopan silmäluvuksi.
  <br></p>
<p>Luvun arpominen suoritetaan palvelimella, koska näin voidaan varmistaa, että huijaamista nopan silmäluvuissa ei tapahdu. Kun luku on arvottu, Hfiver päivittää näkymää alla olevan funktion avulla, joka puolestaan muuttaa DOM:a fiver.css:n (liite 1 sivu 20) ja fiver.html:n (liite 1 sivu 20) osalta:
</p>
<pre>Hfiver = HControl.extend({
tileSize: 60,
componentName: 'fiver',
refreshValue: function(){
var
_val = this.value,
_tileHeight = this.tileSize;
if(_val&gt;=1 &amp;&amp; _val&lt;=6){
var _tilePosY = 0-(_val*_tileHeight);
this.setStyleOfPart('state','background-position','0px
'+_tilePosY+'px');
}
else{ var _tilePosY = 0-(7*_tileHeight);
this.setStyleOfPart('state','background-position','0px
'+_tilePosY+'px');
}
}
});
</pre>
<p>Funktion _val arvo on siis välitetty palvelinpuolen metodilta ja HFiver näyttää tuon arvon mukaisen silmäluvun, muuttamalla html-elementin taustakuvaa.
</p>
<p><img title="ScreenHunter_05_Nov._27_22.14" alt="ScreenHunter_05_Nov._27_22.14" src="_booki/rsence/static/RSence-ScreenHunter_05_Nov-_27_22-14-fi.gif" height="446" width="264"></p>
<p>
</p>
<p>Kuvassa 9 havainnollistetaan, kuinka yhdellä ja samalla kuvalla voidaan näyttää kaikki mahdolliset silmäluvut. Tätä tekniikkaa kutsutaan myös CSSSprite:ksi. Alkutilanteessa kuvasta näytetään silmälukua X, kun noppaa heitetään( roll()), arvotaan uusi silmäluku ja kuva liikutetaan näyttämään uutta silmälukua.
  <br></p>
<p>
</p>
<p>
  <br></p>
</div></div>

  <div class="navbar">
    <div class="arrow bottom left"><a href="#"><img src="/static/lefttext.png" height="20" alt=""></a></div>
    <div class="arrow bottom right"><a href="#"><img src="/static/righttext.png" height="20" alt=""></a></div>
  </div>
</div>

